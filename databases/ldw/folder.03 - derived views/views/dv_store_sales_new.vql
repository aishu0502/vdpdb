CREATE OR REPLACE VIEW dv_store_sales_new FOLDER = '/03 - derived views'
    PRIMARY KEY ( 'ss_item_sk' , 'ss_ticket_number' ) AS SELECT dv_sales_date_oracle.ss_sold_date_sk AS ss_sold_date_sk, dv_sales_date_oracle.ss_sold_time_sk AS ss_sold_time_sk, dv_sales_date_oracle.ss_item_sk AS ss_item_sk, dv_sales_date_oracle.ss_customer_sk AS ss_customer_sk, dv_sales_date_oracle.ss_cdemo_sk AS ss_cdemo_sk, dv_sales_date_oracle.ss_hdemo_sk AS ss_hdemo_sk, dv_sales_date_oracle.ss_addr_sk AS ss_addr_sk, dv_sales_date_oracle.ss_store_sk AS ss_store_sk, dv_sales_date_oracle.ss_promo_sk AS ss_promo_sk, dv_sales_date_oracle.ss_ticket_number AS ss_ticket_number, dv_sales_date_oracle.ss_quantity AS ss_quantity, dv_sales_date_oracle.ss_wholesale_cost AS ss_wholesale_cost, dv_sales_date_oracle.ss_list_price AS ss_list_price, dv_sales_date_oracle.ss_sales_price AS ss_sales_price, dv_sales_date_oracle.ss_ext_discount_amt AS ss_ext_discount_amt, dv_sales_date_oracle.ss_ext_sales_price AS ss_ext_sales_price, dv_sales_date_oracle.ss_ext_wholesale_cost AS ss_ext_wholesale_cost, dv_sales_date_oracle.ss_ext_list_price AS ss_ext_list_price, dv_sales_date_oracle.ss_ext_tax AS ss_ext_tax, dv_sales_date_oracle.ss_coupon_amt AS ss_coupon_amt, dv_sales_date_oracle.ss_net_paid AS ss_net_paid, dv_sales_date_oracle.ss_net_paid_inc_tax AS ss_net_paid_inc_tax, dv_sales_date_oracle.ss_net_profit AS ss_net_profit, dv_sales_date_oracle.d_year AS d_year FROM dv_sales_date_oracle WHERE d_year >= getyear(now()) CONTEXT ('I18N' = 'us_pst');

ALTER VIEW dv_store_sales_new
 LAYOUT (dv_sales_date_oracle = [20, 20, 241, 506]);

