CREATE OR REPLACE VIEW dv_customer_item_sales FOLDER = '/03 - derived views' DESCRIPTION = 'Single view approach to demonstrate Logical Data Warehouse'  AS SELECT bv_ldw_item_mysql.i_item_sk AS i_item_sk, bv_ldw_item_mysql.i_item_id AS i_item_id, bv_ldw_item_mysql.i_rec_start_date AS i_rec_start_date, bv_ldw_item_mysql.i_rec_end_date AS i_rec_end_date, bv_ldw_item_mysql.i_item_desc AS i_item_desc, bv_ldw_item_mysql.i_current_price AS i_current_price, bv_ldw_item_mysql.i_wholesale_cost AS i_wholesale_cost, bv_ldw_item_mysql.i_brand_id AS i_brand_id, bv_ldw_item_mysql.i_brand AS i_brand, bv_ldw_item_mysql.i_class_id AS i_class_id, bv_ldw_item_mysql.i_class AS i_class, bv_ldw_item_mysql.i_category_id AS i_category_id, bv_ldw_item_mysql.i_category AS i_category, bv_ldw_item_mysql.i_manufact_id AS i_manufact_id, bv_ldw_item_mysql.i_manufact AS i_manufact, bv_ldw_item_mysql.i_size AS i_size, bv_ldw_item_mysql.i_formulation AS i_formulation, bv_ldw_item_mysql.i_color AS i_color, bv_ldw_item_mysql.i_units AS i_units, bv_ldw_item_mysql.i_container AS i_container, bv_ldw_item_mysql.i_manager_id AS i_manager_id, bv_ldw_item_mysql.i_product_name AS i_product_name, bv_ldw_store_sales_oracle.ss_sold_date_sk AS ss_sold_date_sk, bv_ldw_store_sales_oracle.ss_sold_time_sk AS ss_sold_time_sk, bv_ldw_store_sales_oracle.ss_item_sk AS ss_item_sk, bv_ldw_store_sales_oracle.ss_customer_sk AS ss_customer_sk, bv_ldw_store_sales_oracle.ss_cdemo_sk AS ss_cdemo_sk, bv_ldw_store_sales_oracle.ss_hdemo_sk AS ss_hdemo_sk, bv_ldw_store_sales_oracle.ss_addr_sk AS ss_addr_sk, bv_ldw_store_sales_oracle.ss_store_sk AS ss_store_sk, bv_ldw_store_sales_oracle.ss_promo_sk AS ss_promo_sk, bv_ldw_store_sales_oracle.ss_ticket_number AS ss_ticket_number, bv_ldw_store_sales_oracle.ss_quantity AS ss_quantity, bv_ldw_store_sales_oracle.ss_wholesale_cost AS ss_wholesale_cost, bv_ldw_store_sales_oracle.ss_list_price AS ss_list_price, bv_ldw_store_sales_oracle.ss_sales_price AS ss_sales_price, bv_ldw_store_sales_oracle.ss_ext_discount_amt AS ss_ext_discount_amt, bv_ldw_store_sales_oracle.ss_ext_sales_price AS ss_ext_sales_price, bv_ldw_store_sales_oracle.ss_ext_wholesale_cost AS ss_ext_wholesale_cost, bv_ldw_store_sales_oracle.ss_ext_list_price AS ss_ext_list_price, bv_ldw_store_sales_oracle.ss_ext_tax AS ss_ext_tax, bv_ldw_store_sales_oracle.ss_coupon_amt AS ss_coupon_amt, bv_ldw_store_sales_oracle.ss_net_paid AS ss_net_paid, bv_ldw_store_sales_oracle.ss_net_paid_inc_tax AS ss_net_paid_inc_tax, bv_ldw_store_sales_oracle.ss_net_profit AS ss_net_profit, bv_ldw_customer_mysql.c_customer_sk AS c_customer_sk, bv_ldw_customer_mysql.c_customer_id AS c_customer_id, bv_ldw_customer_mysql.c_current_cdemo_sk AS c_current_cdemo_sk, bv_ldw_customer_mysql.c_current_hdemo_sk AS c_current_hdemo_sk, bv_ldw_customer_mysql.c_current_addr_sk AS c_current_addr_sk, bv_ldw_customer_mysql.c_first_shipto_date_sk AS c_first_shipto_date_sk, bv_ldw_customer_mysql.c_first_sales_date_sk AS c_first_sales_date_sk, bv_ldw_customer_mysql.c_salutation AS c_salutation, bv_ldw_customer_mysql.c_first_name AS c_first_name, bv_ldw_customer_mysql.c_last_name AS c_last_name, bv_ldw_customer_mysql.c_preferred_cust_flag AS c_preferred_cust_flag, bv_ldw_customer_mysql.c_birth_day AS c_birth_day, bv_ldw_customer_mysql.c_birth_month AS c_birth_month, bv_ldw_customer_mysql.c_birth_year AS c_birth_year, bv_ldw_customer_mysql.c_birth_country AS c_birth_country, bv_ldw_customer_mysql.c_login AS c_login, bv_ldw_customer_mysql.c_email_address AS c_email_address, bv_ldw_customer_mysql.c_last_review_date_sk AS c_last_review_date_sk FROM bv_ldw_item_mysql AS bv_ldw_item_mysql INNER JOIN (bv_ldw_store_sales_oracle AS bv_ldw_store_sales_oracle INNER JOIN "Bv_ldw_customer_mysql1" AS bv_ldw_customer_mysql ON bv_ldw_store_sales_oracle.ss_customer_sk = bv_ldw_customer_mysql.c_customer_sk ) ON bv_ldw_item_mysql.i_item_sk = bv_ldw_store_sales_oracle.ss_item_sk  CONTEXT ('I18N' = 'us_pst');

ALTER VIEW dv_customer_item_sales
 LAYOUT (bv_ldw_item_mysql = [60, 300, 200, 225], bv_ldw_store_sales_oracle = [390, 60, 200, 225], "Bv_ldw_customer_mysql1" = [792, 338, 200, 225]);

