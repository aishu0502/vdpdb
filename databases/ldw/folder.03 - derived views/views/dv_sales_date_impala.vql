CREATE OR REPLACE VIEW dv_sales_date_impala FOLDER = '/03 - derived views'
    PRIMARY KEY ( 'ss_item_sk' , 'ss_ticket_number' ) AS SELECT bv_ldw_store_sales_impala.ss_sold_date_sk AS ss_sold_date_sk, bv_ldw_store_sales_impala.ss_sold_time_sk AS ss_sold_time_sk, bv_ldw_store_sales_impala.ss_item_sk AS ss_item_sk, bv_ldw_store_sales_impala.ss_customer_sk AS ss_customer_sk, bv_ldw_store_sales_impala.ss_cdemo_sk AS ss_cdemo_sk, bv_ldw_store_sales_impala.ss_hdemo_sk AS ss_hdemo_sk, bv_ldw_store_sales_impala.ss_addr_sk AS ss_addr_sk, bv_ldw_store_sales_impala.ss_store_sk AS ss_store_sk, bv_ldw_store_sales_impala.ss_promo_sk AS ss_promo_sk, bv_ldw_store_sales_impala.ss_ticket_number AS ss_ticket_number, bv_ldw_store_sales_impala.ss_quantity AS ss_quantity, bv_ldw_store_sales_impala.ss_wholesale_cost AS ss_wholesale_cost, bv_ldw_store_sales_impala.ss_list_price AS ss_list_price, bv_ldw_store_sales_impala.ss_sales_price AS ss_sales_price, bv_ldw_store_sales_impala.ss_ext_discount_amt AS ss_ext_discount_amt, bv_ldw_store_sales_impala.ss_ext_sales_price AS ss_ext_sales_price, bv_ldw_store_sales_impala.ss_ext_wholesale_cost AS ss_ext_wholesale_cost, bv_ldw_store_sales_impala.ss_ext_list_price AS ss_ext_list_price, bv_ldw_store_sales_impala.ss_ext_tax AS ss_ext_tax, bv_ldw_store_sales_impala.ss_coupon_amt AS ss_coupon_amt, bv_ldw_store_sales_impala.ss_net_paid AS ss_net_paid, bv_ldw_store_sales_impala.ss_net_paid_inc_tax AS ss_net_paid_inc_tax, bv_ldw_store_sales_impala.ss_net_profit AS ss_net_profit, bv_ldw_date_impala.d_year AS d_year FROM bv_ldw_store_sales_impala AS bv_ldw_store_sales_impala INNER JOIN bv_ldw_date_impala AS bv_ldw_date_impala ON bv_ldw_store_sales_impala.ss_sold_date_sk = bv_ldw_date_impala.d_date_sk  CONTEXT ('I18N' = 'us_pst');

ALTER VIEW dv_sales_date_impala
 LAYOUT (bv_ldw_store_sales_impala = [20, 20, 200, 225], bv_ldw_date_impala = [428, 111, 200, 225]);

