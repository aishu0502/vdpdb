CREATE OR REPLACE VIEW dv_total_sales_by_customer FOLDER = '/03 - derived views' AS SELECT bv_ldw_customer_mysql.c_customer_sk AS c_customer_sk, bv_ldw_customer_mysql.c_first_name AS c_first_name, bv_ldw_customer_mysql.c_last_name AS c_last_name, bv_ldw_customer_mysql.c_preferred_cust_flag AS c_preferred_cust_flag, bv_ldw_customer_mysql.c_birth_country AS c_birth_country, bv_ldw_customer_mysql.c_login AS c_login, bv_ldw_customer_mysql.c_email_address AS c_email_address, sum(bv_ldw_store_sales_oracle.ss_ext_sales_price) AS sum_agg, 'S' AS sale_type FROM "Bv_ldw_customer_mysql1" AS bv_ldw_customer_mysql INNER JOIN bv_ldw_store_sales_oracle AS bv_ldw_store_sales_oracle ON bv_ldw_customer_mysql.c_customer_sk = bv_ldw_store_sales_oracle.ss_customer_sk  GROUP BY bv_ldw_customer_mysql.c_customer_sk, bv_ldw_customer_mysql.c_first_name, bv_ldw_customer_mysql.c_last_name, bv_ldw_customer_mysql.c_preferred_cust_flag, bv_ldw_customer_mysql.c_birth_country, bv_ldw_customer_mysql.c_login, bv_ldw_customer_mysql.c_email_address CONTEXT ('I18N' = 'us_pst');

ALTER VIEW dv_total_sales_by_customer
 LAYOUT ("Bv_ldw_customer_mysql1" = [150, 120, 420, 230], bv_ldw_store_sales_oracle = [640, 160, 420, 220]);

